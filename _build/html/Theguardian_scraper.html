
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data collection &#8212; Predicting Football Match Outcomes using Machine Learning and Human Experts input</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Natural language processing Task" href="Task_2_NLP_Review.html" />
    <link rel="prev" title="Literature review" href="Literature_review.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Predicting Football Match Outcomes using Machine Learning and Human Experts input</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro.html">
   A multi-task learning approach to predict the outcome of a football game using human experts input
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Literature_review.html">
   Literature review
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Data collection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Task_2_NLP_Review.html">
   Natural language processing Task
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Model_Evaluation.html">
   Model Evaluation
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Theguardian_scraper.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FTheguardian_scraper.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Theguardian_scraper.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-preliminary-examination-of-the-guardian-s-website">
   A preliminary examination of the Guardian’s website
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-of-the-scraper-output">
   Example of the scraper output
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Data collection</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-preliminary-examination-of-the-guardian-s-website">
   A preliminary examination of the Guardian’s website
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-of-the-scraper-output">
   Example of the scraper output
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="data-collection">
<h1>Data collection<a class="headerlink" href="#data-collection" title="Permalink to this headline">¶</a></h1>
<p>Data is essential in all activities, but gathering it appears to be a difficult task.
It is required for any data science project because it is used to build a mathematical model to detect the most important trends.The better the quality of our data, the better the model’s performance.
<br>For our project, data is a critical tool for developing a multi-task learning model.
<br>And, as mentioned in the previous chapter, our goal is to use previews texts written by human football experts that describe the environment and pre-match events to predict the outcomes of football matches.
<br>To reach the aim of our project, we have begun the first task, which is to collect football previews from The Guardian’s digital edition.
<br>It should be noted that this project is adaptable to any football league or data source. However, this option was chosen because the textual data is readily available, structured, and <a class="reference external" href="http://plentiful.It">plentiful.It</a> goes back far enough, from 2009 to today, to allow us to integrate deep neural networks.
<br>Indeed, “The Guardian’s” football experts publish previews every week, usually two or three days before the matches.
<br>In this regard, we began by creating a data extraction tool that will allow us to extract this information on a regular basis.
<br>The information to be extracted is as follows:</p>
<ul class="simple">
<li><p>The names of the competing teams.</p></li>
<li><p>The date of the game</p></li>
<li><p>The identity of the referee</p></li>
<li><p>The stadium’s name</p></li>
<li><p>Sports odds that will be converted to decimal format</p></li>
<li><p>The football expert’s text</p></li>
<li><p>The text’s author.</p></li>
</ul>
<div class="section" id="a-preliminary-examination-of-the-guardian-s-website">
<h2>A preliminary examination of the Guardian’s website<a class="headerlink" href="#a-preliminary-examination-of-the-guardian-s-website" title="Permalink to this headline">¶</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Issues</p></th>
<th class="head"><p>Solutions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>4 possible formats for previews(old format, new format,Cup’s format and a particular format)</p></td>
<td><p>Select the appropriate html tags</p></td>
</tr>
<tr class="row-odd"><td><p>Preview titles are not the same ( we can find Squad Sheets or match preview)</p></td>
<td><p>Pick only the names of the teams and eliminate the rest</p></td>
</tr>
<tr class="row-even"><td><p>The date of the match is not always available</p></td>
<td><p>Pick the preview date</p></td>
</tr>
<tr class="row-odd"><td><p>The order of the elements and labels are not the same</p></td>
<td><p>Using regex patterns to get information</p></td>
</tr>
<tr class="row-even"><td><p>Missing values for betting odds</p></td>
<td><p>We treat the general case separately and we set up specific regex patterns for these particular cases</p></td>
</tr>
<tr class="row-odd"><td><p>Odds format is different</p></td>
<td><p>We treat the general case separately and we set up specific regex patterns for these particular cases</p></td>
</tr>
<tr class="row-even"><td><p>We can find non-numeric values for Odds like (Evens,evens,Eve,odds-on)</p></td>
<td><p>Replace evens by 1-1</p></td>
</tr>
<tr class="row-odd"><td><p>There are some previews that don’t have author and text</p></td>
<td><p>For previews that have no text, we put None (not available)</p></td>
</tr>
<tr class="row-even"><td><p>The existence of previews for the FA CUP,Carabao Cup,Champions league,World Cup</p></td>
<td><p>Filter previews by checking if the match exists in “Opta” database, and pick only Premier League match</p></td>
</tr>
<tr class="row-odd"><td><p>We are not sure if the names of the teams are the same as the ones in Opta</p></td>
<td><p>Set up a dictionary or check manually to map teams to their IDs</p></td>
</tr>
<tr class="row-even"><td><p>When we send many requests, the guardian server blocks your IP address, which is interpreted as a DDOS attack</p></td>
<td><p>Do a sleep of a random x seconds between requests or change IP address and work with rotating proxy</p></td>
</tr>
</tbody>
</table>
<p><b>The guardian</b> previews are spread across several pages, so our extraction tool will go through all of them, extracting the previews as it goes.
<br>Indeed, the scraper extracts information from <b>Premier League</b> match previews using two methods:
<br>The first method is to use the api provided by <b>The Guardian’s</b> website, by introducing a connection key and a well-parsed portion of the link.
<br>For example, a link is formatted as <a class="reference external" href="https://www.theguardian.com/football/2022/feb/12/newcastle-aston-villa-match-preview-premier-league">https://www.theguardian.com/football/2022/feb/12/newcastle-aston-villa-match-preview-premier-league</a>, <b>the guardian</b> API only requires “football/2022/feb/12/newcastle-aston-villa-match-preview-premier-league.”
<br>However, this method is not always reliable because the API is not always functional for some previews. So, in this case, our scraper employs its second method, which is the traditional approach of scraping the html format of the pages.
<br>We identified some special cases by analyzing the website; there are some changes in form and content, so we attempted to find a set of regular expressions that dealt with generic and special cases in order to locate the various information.
<br>Following the data extraction stage, information will be normalized and cleaned, and betting odds extracted from the previews will be converted to a decimal format.
<br>Then, to ensure that we are only extracting <b>English Premier League</b> matches, we map the extracted preview by its equivalent in a database called <b>Opta</b> by introducing the names of the two opposing teams, the competition id, and the closest game date to the date of the preview. This mapping returns the match id and the date of the game.
However, <b>Opta</b> is a trustworthy database provided by <b>Opta Sport</b>, the pan-European leader in the supply of sports information data.
Moreover, prior to this phase, we were unsure of the correspondence between the names of the teams written by <b>the guardian</b> and the names of the teams in <b>Opta</b>. For example, a single team can be referred to in several ways, such as <b>Manchester United, Manchester Utd, Man United, Man Utd</b> and so on.
<br>To address this issue, we created a dictionary containing the various possible names of <b>103 English teams</b> competing in the first and second divisions. This dataset was created in two ways: the first using <b>Opta</b>, which provides the various team aliases, and the second manually, in which we added other nicknames that were not provided.
<br>Finally, once the mapping process is done, this information will be gradually stored in a <b>Mongodb</b> database, specifically in a collection called <b>Previews</b>.
<br>It should be noted that when the scraper is launched, it checks the last date stored in the <b>Previews</b> collection to determine at what level it will stop.
<br>This scraper has extracted data from 2009 to the present and is <b> operational in a production environment </b>.
<br>Our package is <b>open source</b> and freely available to all developers on <b>Github</b> and <b>Pypi</b> (default software repository for Python developers to store created Python programming language).</p>
</div>
<div class="section" id="example-of-the-scraper-output">
<h2>Example of the scraper output<a class="headerlink" href="#example-of-the-scraper-output" title="Permalink to this headline">¶</a></h2>
<p><img alt="The scraper output!" src="_images/scraper_output_1.png" /></p>
<p><img alt="The scraper output!" src="_images/scraper_output_2.png" /></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Literature_review.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Literature review</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Task_2_NLP_Review.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Natural language processing Task</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Meher Kharbachi<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>